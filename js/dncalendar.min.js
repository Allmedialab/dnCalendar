(function(a){a.fn.dnCalendar=function(p){var m=a(this);var b={};var e=new Date();var j=null;var f=new Date();var h=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];Array.prototype.move=function(s,q){while(s<0){s+=this.length}while(q<0){q+=this.length}if(q>=this.length){var r=q-this.length;while((r--)+1){this.push(undefined)}}this.splice(q,0,this.splice(s,1)[0]);return this};var n=function(){console.log("settings",b);for(var q=0;q<h.length;q++){if(h[q]==b.startWeek.toLowerCase()){return q}}return 0};var d=function(s,u){var t=new Date(s,u-1,1);var q=new Date(s,u,0);var r=t.getDay()+q.getDate();return Math.ceil(r/7)};var i=function(T){var ag=e.getMonth();var ao=e.getDate();var aa=e.getFullYear();var N=b.monthNames[ag];if(b.monthUseShortName==true){N=b.monthNamesShort[ag]}var ae=a("<div id='dncalendar-header' class='dncalendar-header'></div>");ae.append("<h2>"+N+" "+aa+"</h2>");var x=false;var t=null;if(typeof b.minDate!=="undefined"){var at=b.minDate.split("-");t=new Date(at[0],at[1]-1,at[2]);if(t.getFullYear()>=aa){if(t.getMonth()>=ag){x=true}}}var Q=false;var C=null;if(typeof b.maxDate!=="undefined"){var J=b.maxDate.split("-");C=new Date(J[0],J[1]-1,J[2]);if(C.getFullYear()<=aa){if(C.getMonth()<=ag){Q=true}}}var W=a("<div id='dncalendar-links' class='dncalendar-links'></div>");var ad=a("<div id='dncalendar-prev-month' class='dncalendar-prev-month'></div>");var D=a("<div id='dncalendar-next-month' class='dncalendar-next-month'></div>");if(x){ad.addClass("dncalendar-inactive");ad.removeAttr("id")}if(Q){D.addClass("dncalendar-inactive");D.removeAttr("id")}W.append(ad);W.append(D);ae.append(W);var F=a("<div id='dncalendar-body' class='dncalendar-body'></div>");var V=a("<table></table>");var R=b.dayNames;if(b.dayUseShortName==true){R=b.dayNamesShort}console.log("is_update",T);console.log("week before",R);var aj=n();if(T==false){var ar=null;var Y=0;for(var al=0;al<R.length;al++){if(al>=aj){if(ar==null){ar=al}R.move(ar,Y);ar++;Y++}}}console.log("week after",R);var E=(aj==0)?0:7-aj;var G=6-aj;var s=a("<thead></thead>");var r=a("<tr></tr>");var an=R.length;for(var al=0;al<an;al++){r.append("<td "+((al==E||al==G)?'class="holiday"':"")+">"+R[al]+"</td>")}s.append(r);var w=a("<tbody></tbody>");var B=d(aa,ag+1);var I=7;var v=1;var q=new Date(aa,ag,1);var ap=new Date(aa,ag+1,0);var U=new Date(aa,ag,0);var X=U.getDate()-q.getDay()+1;var u=new Date(aa,ag+1,1);var af=u.getDate();var O=0;if(t!=null){O=t.getDate()}var Z=0;if(C!=null){Z=C.getDate()}var A="today";var ak="default date";if(typeof b.dataTitles!=="undefined"){if(typeof b.dataTitles.defaultDate!=="undefined"){ak=b.dataTitles.defaultDate}if(typeof b.dataTitles.today!=="undefined"){A=b.dataTitles.today}}var S=I+aj-1;var E=(aj==0)?0:S-aj;var G=(aj==0)?I-1:S-aj+1;for(var al=0;al<B;al++){var ac=a("<tr></tr>");for(var ai=aj;ai<I+aj;ai++){if((al!=0&&al!=B-1)||(al==0&&ai>=q.getDay())||(al==B-1&&ai<=ap.getDay())){var z="";var L="";if(f.getFullYear()==aa&&f.getMonth()==ag&&f.getDate()==v){z=" today-date ";L="data-title='"+A+"'"}if(j!=null&&j.getFullYear()==aa&&j.getMonth()==ag&&j.getDate()==v){z=" default-date ";L="data-title='"+ak+"'"}if(ai==E||ai==G){z+=" holiday "}if(typeof b.notes!=="undefined"){if(l(new Date(aa,ag,v))){z+=" note "}}var ab="<td id='calendarClick' class='"+z+" calendarClick' data-date='"+v+"' data-month='"+(ag+1)+"' data-year='"+aa+"'><div class='entry' "+L+">"+v+"</div></td>";if(t!=null){if(t.getFullYear()>=aa){if(t.getMonth()>=ag&&v<O){ab="<td class='"+z+"' data-date='"+v+"' data-month='"+(ag+1)+"' data-year='"+aa+"'><div class='entry' "+L+">"+v+"</div></td>"}}}if(C!=null){if(C.getFullYear()<=aa){if(C.getMonth()<=ag&&v>Z){ab="<td class='"+z+"' data-date='"+v+"' data-month='"+(ag+1)+"' data-year='"+aa+"'><div class='entry' "+L+">"+v+"</div></td>"}}}ac.append(ab);v++}else{if(al==0){var z="";var L="";if(f.getFullYear()==U.getFullYear()&&f.getMonth()==U.getMonth()&&f.getDate()==X){z=" today-date ";L="data-title='"+A+"'"}if(j!=null&&j.getFullYear()==U.getFullYear()&&j.getMonth()==U.getMonth()&&j.getDate()==X){z=" default-date ";L="data-title='"+ak+"'"}if(ai==E||ai==G){z+=" holiday "}if(typeof b.notes!=="undefined"){if(l(new Date(U.getFullYear(),U.getMonth(),X))){z+=" note "}}var ab="<td id='calendarClick' class='"+z+"' data-date='"+X+"' data-month='"+(U.getMonth()+1)+"' data-year='"+U.getFullYear()+"'><div class='entry' "+L+">"+X+"</div></td>";if(t!=null){if(t.getFullYear()>U.getFullYear()){ab="<td class='"+z+"' data-date='"+X+"' data-month='"+(U.getMonth()+1)+"' data-year='"+U.getFullYear()+"'><div class='entry' "+L+">"+X+"</div></td>"}else{if(t.getFullYear()==U.getFullYear()&&t.getMonth()>U.getMonth()){ab="<td class='"+z+"' data-date='"+X+"' data-month='"+(U.getMonth()+1)+"' data-year='"+U.getFullYear()+"'><div class='entry' "+L+">"+X+"</div></td>"}}}ac.append(ab);X++}if(al==B-1){var z="";var L="";if(f.getFullYear()==u.getFullYear()&&f.getMonth()==u.getMonth()&&f.getDate()==af){z=" today-date ";L="data-title='"+A+"'"}if(j!=null&&j.getFullYear()==u.getFullYear()&&j.getMonth()==u.getMonth()&&j.getDate()==af){z=" default-date ";L="data-title='"+ak+"'"}if(ai==E||ai==G){z+=" holiday "}if(typeof b.notes!=="undefined"){if(l(new Date(u.getFullYear(),u.getMonth(),af))){z+=" note "}}var ab="<td id='calendarClick' class='"+z+"' data-date='"+af+"' data-month='"+(u.getMonth()+1)+"' data-year='"+u.getFullYear()+"'><div class='entry' "+L+">"+af+"</div></td>";if(C!=null){if(C.getFullYear()<=u.getFullYear()){if(C.getMonth()<=u.getMonth()){if(C.getMonth()<u.getMonth()){ab="<td class='"+z+"' data-date='"+af+"' data-month='"+(u.getMonth()+1)+"' data-year='"+u.getFullYear()+"'><div class='entry' "+L+">"+af+"</div></td>"}else{if(Z<af){ab="<td class='"+z+"' data-date='"+af+"' data-month='"+(u.getMonth()+1)+"' data-year='"+u.getFullYear()+"'><div class='entry' "+L+">"+af+"</div></td>"}}}}}ac.append(ab);af++}}}w.append(ac)}var aq="";if(b.showNotes){var ah=o();var P=ah.length;if(P>0){aq=a("<ul class='dncalendar-note-list'></ul>");for(var al=0;al<P;al++){var am=ah[al].date;var K=ah[al].notes;var H=K.length;var M="";M+="<li class='date'>";M+="<span>"+am+"</span> ";if(H>0){M+=" : ";for(var ai=0;ai<H;ai++){M+=K[ai];if(H<=ai){M+=", "}}}M+="</li>";aq.append(M)}}}V.append(s);V.append(w);F.append(V);m.html("");m.append(ae);m.append(F);m.append(aq)};var l=function(r){var u=b.notes.length;for(var t=0;t<u;t++){var s=b.notes[t].date.split("-");var q=new Date(s[0],s[1]-1,s[2]);if(q.getFullYear()==r.getFullYear()&&q.getMonth()==r.getMonth()&&q.getDate()==r.getDate()){return true}}return false};var o=function(){var r=[];var v=b.notes.length;for(var u=0;u<v;u++){var t=b.notes[u].date.split("-");var q=new Date(t[0],t[1]-1,t[2]);if(q.getFullYear()==e.getFullYear()&&q.getMonth()==e.getMonth()){var s={};s.date=q.getDate();s.notes=b.notes[u].note;r.push(s)}}return r};var g=function(){var q=new Date(e.getFullYear(),e.getMonth()+1,1);var r=q.getDate();var t=q.getMonth();var s=q.getFullYear();e=new Date(s,t,r);i()};var c=function(){var s=new Date(e.getFullYear(),e.getMonth()-1,1);var q=s.getDate();var t=s.getMonth();var r=s.getFullYear();e=new Date(r,t,q);i()};var k=function(){a("body").on("click","#calendarClick",function(){var q=a(this).data("date");var r=a(this).data("month");var s=a(this).data("year");b.dayClick.call(this,new Date(s,r-1,q),m)});a("body").on("click","#dncalendar-prev-month",function(){c()});a("body").on("click","#dncalendar-next-month",function(){g()})};return{build:function(){b=a.extend({},a.fn.dnCalendar.defaults,p);if(typeof b.defaultDate!=="undefined"){var q=b.defaultDate.split("-");e=new Date(q[0],q[1]-1,q[2]);j=e}i(false);k()},update:function(r){b=a.extend(b,r);if(typeof b.defaultDate!=="undefined"){var q=b.defaultDate.split("-");e=new Date(q[0],q[1]-1,q[2]);j=e}i(true)}}};a.fn.dnCalendar.defaults={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Agu","Sep","Okt","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayUseShortName:false,monthUseShortName:false,showNotes:false,startWeek:"sunday",dayClick:function(c,b){}}}(jQuery));